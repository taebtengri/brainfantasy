<!DOCTYPE html>
<html>
<head>
	<title>Литконкурс</title>
		<!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css"> -->
	  	<script src="https://code.jquery.com/jquery.js"></script>
	  	<!-- <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script> -->
	  	<script
  src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"
  integrity="sha256-T0Vest3yCU7pafRw9r+settMBX6JkKN06dqBnpQ8d30="
  crossorigin="anonymous"></script>
	  	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>
		<link rel="stylesheet" href="style.css">
		<link rel="stylesheet" href="/public/style.css">


</head>
<script type="text/javascript">
	!function(a){function f(a,b){if(!(a.originalEvent.touches.length>1)){a.preventDefault();var c=a.originalEvent.changedTouches[0],d=document.createEvent("MouseEvents");d.initMouseEvent(b,!0,!0,window,1,c.screenX,c.screenY,c.clientX,c.clientY,!1,!1,!1,!1,0,null),a.target.dispatchEvent(d)}}if(a.support.touch="ontouchend"in document,a.support.touch){var e,b=a.ui.mouse.prototype,c=b._mouseInit,d=b._mouseDestroy;b._touchStart=function(a){var b=this;!e&&b._mouseCapture(a.originalEvent.changedTouches[0])&&(e=!0,b._touchMoved=!1,f(a,"mouseover"),f(a,"mousemove"),f(a,"mousedown"))},b._touchMove=function(a){e&&(this._touchMoved=!0,f(a,"mousemove"))},b._touchEnd=function(a){e&&(f(a,"mouseup"),f(a,"mouseout"),this._touchMoved||f(a,"click"),e=!1)},b._mouseInit=function(){var b=this;b.element.bind({touchstart:a.proxy(b,"_touchStart"),touchmove:a.proxy(b,"_touchMove"),touchend:a.proxy(b,"_touchEnd")}),c.call(b)},b._mouseDestroy=function(){var b=this;b.element.unbind({touchstart:a.proxy(b,"_touchStart"),touchmove:a.proxy(b,"_touchMove"),touchend:a.proxy(b,"_touchEnd")}),d.call(b)}}}(jQuery);
</script>
<script>
  $( function() {
    $( "tbody" ).sortable({
    	connectWith: ".con",
    	 cancel:".disabled"
    });
    $( "tbody" ).disableSelection();
  } );
  </script>
  <style>
  #sortable { list-style-type: none; margin: 0; padding: 0; width: 60%; }
  #sortable li { margin: 0 3px 3px 3px; padding: 0.4em; padding-left: 1.5em; font-size: 1.4em; height: 18px; }
  #sortable li span { position: absolute; margin-left: -1.3em; }
  </style>
  <style>
#makeMeDraggable { width: 300px; height: 300px; background: red; }
</style>
<body>
<div class="container">
<div class="">
	<div class="row">
		<div class="col-md-9">
			<h1 class="fifty">XIV Хрустящий Литконкурс</h1>
			<h2>Страница оценивания</h2>
			
		</div>
		<!--<div class="col-md-2">
			<h3 id="salam">Salam, <a href="#">username</a>!</h3>
		</div>-->
	</div>
	<!--<div class="row">
		<div class="col-md-6">
			<div class="btn-toolbar plashka" role="toolbar" aria-label="Toolbar with button groups">
			  
			    <button type="button" class="btn btn-primary" onclick="window.location.href='/'">Ana səhifə
			    </button>
			    <button type="button" class="btn btn-primary" onclick="window.location.href='/transfer'">Transferlər</button>
			    <button type="button" class="btn btn-primary" onclick="window.location.href='/rating'">Reytinq</button>
			    <button type="button" class="btn btn-primary" onclick="window.location.href='/signout'">Çıxış</button>
			  
			</div>
		</div>
		
	</div> -->
	<div class="row">
		<div class="col-md-12">
			<h3>До конца периода оценивания осталось <span id="transferTime"></span></h3>
			<h4>Отсортируйте рассказы, перетаскивая их в списке и закрепляя их.<br> Когда все рассказы будут закреплены, нажмите кнопку "отправить".</h4>
		</div>
			
		</div>
		</div>
	<div class="row">
		<!--<div class="col-lg-5 l">
			<h2>Transfer pulunuz: <span id="pul"></span> </h2><br>
			<h2>Ваш рейтинг рассказов:</h2>
			<div id="koman">
			<div class="komanda">

			
				
				
			
			</div>
			</div>
			<button class="btn-primary qeyd">Отправить</button>
			<button class="btn-danger udalit">Очистить</button>	

		</div>-->
		<div class="col-lg-10 r">
			<h2>Рассказы:</h2>
			<div id="oyuncular">
			<table class="table table-inverse" id="table">
			<thead>
	          <tr>
	                  <th>Номер</th>
	                  <th>Название</th>
	                 
	                  <th></th>
	          </tr>
	          </thead>
	          <tbody id="sortable" class="con">
          	  </tbody>
             
              
            
          </table>
          <button class="btn-primary qeyd">Отправить</button>
		  <button class="btn-danger udalit">Очистить</button>	
				
			</div>
		</div>
	</div>
	
</div>



</body>
<script type="text/javascript">
var counter = 0;
	function handledata(data) {
	 $(".results").html(" ");
		 console.log(data);
		 counter = 0;
        for (var i = 0; i < data.length; i++) {
        var wellSection = $("<tr class='results well'>");
        //wellSection.addClass("well");
        //wellSection.addClass("ui-sortable");
        wellSection.attr("id", "c" + i);
        $("tbody").append(wellSection);

        $("#c" + i).append("<th class='imya'>" + data[i].id + "</th>");
        $("#c" + i).append("<th>" + data[i].name + "</th>");
        $("#c" + i).append("<th><textarea rows='2' cols='20' id='comment' enabled></textarea></th>");
        $("#c" + i).append("<th><button type='button' class='btn btn-success dobavit' id='"+i+"'>Закрепить</button></th></tr>");
        


      
	


       	counter++;
        console.log("xexexexe");

      }
  //     $("#sortable").sortable('refresh');
  //     $( function() {
  //   $( "#sortable" ).sortable();
  //   $( "#sortable" ).disableSelection();
  // } );
      //setTimeout(saved, 1000);
	}


	function populate() {
	$.ajax({
	url:"/players",
	type: 'GET'}).done(handledata)
        //event.preventDefault();
    }
    populate();
    // Set the date we're counting down to
var countDownDate = new Date("Sep 10, 2017 15:37:25").getTime();

// Update the count down every 1 second
var x = setInterval(function() {

    // Get todays date and time
    var now = new Date().getTime();
    
    // Find the distance between now an the count down date
    var distance = countDownDate - now;
    
    // Time calculations for days, hours, minutes and seconds
    var days = Math.floor(distance / (1000 * 60 * 60 * 24));
    var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
    var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
    var seconds = Math.floor((distance % (1000 * 60)) / 1000);
    
    // Output the result in an element with id="demo"
    document.getElementById("transferTime").innerHTML = days + " дней " + hours + " часов "
    + minutes + " минут " + seconds + " секунд ";
    
    // If the count down is over, write some text 
    if (distance < 0) {
        clearInterval(x);
        document.getElementById("transferTime").innerHTML = "Время окончено";
    }
}, 1000);
/////////////////////////////////////////////////////////////////////////////////

var team = [];
var steam = [];
var scounter = 0;
$(document).on('click', 'button.dobavit', function () {
	 if ($(this).html() == "Закрепить") {
     $(this).html("Открепить")
     $(this).addClass("btn-danger");
     $(this).parent().siblings().css({"color": "red"});
     $(this).parent().parent().addClass("disabled");
     scounter++
     console.log(team);
 }
 else {
 	 $(this).html("Закрепить")
     $(this).removeClass("btn-danger");
     $(this).parent().siblings().css({"color": "white"});
     $(this).parent().parent().removeClass("disabled");
     scounter--
     console.log(team);
 	
 }

     return false;   

 });


  $(document).on('click', 'button.qeyd', function () {
  	if (scounter < counter) {
  		alert("Не все рассказы закреплены!");
  	}
  	else if (scounter == counter) {
  		alert("Рассказы отсортированы");
  	}
  	else {
  		alert("ERROR")
  	}


 });

$(document).on('click', 'button.udalit', function () {
  	$(".dobavit").html("Закрепить").removeClass("btn-danger").parent().siblings().css({"color": "white"});
  	$(".dobavit").parent().parent().removeClass("disabled");
  	scounter = 0;





 });




 var teamsend = [];

 $(".qeyd").click(function(){
 	

 })







</script>
</html>